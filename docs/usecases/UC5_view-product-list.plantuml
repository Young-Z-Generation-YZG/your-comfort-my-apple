@startuml UC5_view-product-list
actor Actor
boundary HomePage
boundary ShopPage
control CatalogController
control GetProductModelsHandler
control MongoRepository
database MongoDB


Actor -> HomePage: 1. click on shop
activate Actor
activate HomePage

HomePage -> ShopPage: 2. clickShopPage()
activate ShopPage

ShopPage -> CatalogController: 3. navigate()
activate CatalogController

CatalogController -> GetProductModelsHandler: 4. getProductModels()
activate GetProductModelsHandler

GetProductModelsHandler -> MongoRepository: 5. GetAllAsync()
activate MongoRepository

MongoRepository -> MongoDB: 6. query()
activate MongoDB
MongoDB --> MongoRepository: 7. return(items, totalRecords, totalPages)
deactivate MongoDB
MongoRepository --> GetProductModelsHandler: 8. return(items, totalRecords, totalPages)
deactivate MongoRepository

alt items found
    GetProductModelsHandler --> CatalogController: 9. return PaginationResponse<ProductModelResponse>
    CatalogController --> ShopPage: 10. return PaginationResponse
    ShopPage --> Actor: 11. display(Product list with pagination)
    opt filters applied
        Actor -> ShopPage: 12. apply filters(colors, storages, models, \nminPrice, maxPrice)
            ref over ShopPage: sd: lọc sản phẩm
    end
    opt click on item
        Actor -> ShopPage: 13. clickOnItem(slug)
            ref over ShopPage: sd: xem chi tiết sản phẩm
    end
else items not found
    GetProductModelsHandler --> CatalogController: 9.1 return PaginationResponse<ProductModelResponse>
    deactivate GetProductModelsHandler
    note right
        items is empty list (0 items)
    end note
    CatalogController --> ShopPage: 9.2 return PaginationResponse
    deactivate CatalogController
    ShopPage --> Actor: 9.3 display("No products found")
    deactivate ShopPage
    deactivate Actor
end
@enduml

